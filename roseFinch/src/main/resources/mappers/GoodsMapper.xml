<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.web.roseFinch.mapper.goodsMapper">

	<resultMap id="goodsVO" type="com.web.roseFinch.goods.vo.GoodsVO">
		<result property="code" column="GDS_CODE" />
		<result property="categoryCode" column="CAT_CODE" />
		<result property="categoryName" column="CAT_NAME" />
		<result property="sellerCode" column="SEL_CODE" />
		<result property="sellerNick" column="SEL_NICK" />
		<result property="name" column="GDS_NAME" />
		<result property="company" column="GDS_COMPANY" />
		<result property="madeby" column="GDS_MADEBY" />
		<result property="price" column="GDS_PRICE" />
		<result property="count" column="GDS_CNT" />
		<result property="sellYesOrNo" column="GDS_SEL_YN" />
		<result property="hit" column="GDS_HIT" />
		<result property="startDate" column="GDS_STR_DATE" />
		<result property="modifyDate" column="GDS_MOD_DATE" />
	</resultMap>
	
	<resultMap id="categoryFilter" type="com.web.roseFinch.goods.vo.CategoryFilterVO">
		<result property="catCode" column="CAT_CODE" />
		<result property="catName" column="CAT_NAME" />
		<result property="catGroup" column="CAT_GROUP" />
		<result property="catLevel" column="CAT_LEVEL" />
	</resultMap>

	<select id="getGoodsList" resultMap="goodsVO" parameterType="string">
		SELECT gds_code, category.cat_code, category.cat_name, seller.sel_code, seller.sel_nick, 
		gds_name, gds_company, gds_madeby, gds_price, gds_cnt, gds_sel_yn, gds_hit, gds_str_date, gds_mod_date FROM goods
		INNER JOIN category ON goods.cat_code = category.cat_code 
		INNER JOIN seller ON goods.sel_code = seller.sel_code WHERE gds_name LIKE CONCAT('%', #{keyword}, '%')
		ORDER BY gds_code DESC;
	</select>
	
	<select id="getDistinctCategoryListOfGoodsList" resultMap="categoryFilter" parameterType="string">
		SELECT DISTINCT goods.cat_code, cat_name, cat_group, cat_level FROM goods INNER JOIN category ON goods.cat_code = category.cat_code WHERE gds_name LIKE CONCAT('%', #{keyword}, '%')
	</select>
	
	<select id="getDistinctCompanyListOfGoodsList" resultType="string" parameterType="string">
	 	SELECT DISTINCT gds_company FROM goods WHERE gds_name LIKE CONCAT('%', #{keyword}, '%');
	</select>
</mapper>